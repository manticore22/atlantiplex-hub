# Vulnerability Remediation Plan

## Executive Summary
- **atlantiplex-stage:latest**: 11 vulnerabilities (0 Critical, 7 High, 1 Medium, 3 Low)
- **atlantiplex-flask:latest**: 13 vulnerabilities (0 Critical, 2 High, 8 Medium, 3 Low)
- **Status**: All vulnerabilities are fixable by updating dependencies

---

## Stage Server (Node.js) Vulnerabilities

### High Priority (7 High Vulnerabilities)

#### 1. tar package (npm)
- **Current**: 6.2.1
- **Fixed versions**: 7.5.4, 7.5.7, 7.5.8
- **CVEs**: 
  - CVE-2026-23950 (Path traversal, CVSS 8.8)
  - CVE-2026-24842 (Path traversal, CVSS 8.2)
  - CVE-2026-23745 (Path traversal, CVSS 8.2)
  - CVE-2026-26960 (Path traversal, CVSS 7.1)
- **Action**: Update to latest tar version
- **File**: `./matrix-studio/web/stage/package.json`

#### 2. cross-spawn package (npm)
- **Current**: 7.0.3
- **Fixed version**: 7.0.5
- **CVE**: CVE-2024-21538 (ReDoS, CVSS 7.7)
- **Action**: Update to cross-spawn@7.0.5+

#### 3. glob package (npm)
- **Current**: 10.4.2
- **Fixed version**: 11.1.0 (or 10.5.0+)
- **CVE**: CVE-2025-64756 (OS Command Injection, CVSS 7.5)
- **Action**: Update to glob@11.1.0+

#### 4. minimatch package (npm)
- **Current**: 9.0.5
- **Fixed version**: 10.2.1
- **CVE**: CVE-2026-26996 (ReDoS, CVSS 8.7)
- **Action**: Update to minimatch@10.2.1+

### Medium/Low Priority (4 Vulnerabilities)
- busybox 1.37.0-r30: CVE-2025-60876 (MEDIUM, not yet fixed in Alpine 3.23)
- zlib 1.3.1-r2: Low severity CVE

**Action for busybox**: Wait for Alpine Linux security update or switch to Alpine 3.24

---

## Flask Backend (Python) Vulnerabilities

### High Priority (2 High Vulnerabilities)

#### 1. Werkzeug 2.3.6
- **Current**: 2.3.6
- **Fixed versions**: 3.0.3, 3.0.6, 3.1.5, 3.1.6
- **CVEs**:
  - CVE-2024-34069 (CSRF, CVSS 7.5)
  - CVE-2024-49767 (Resource Consumption, CVSS 6.9)
  - CVE-2026-27199 (Device name handling, CVSS 6.3)
  - CVE-2026-21860 (Device name handling, CVSS 6.3)
- **Action**: Update Flask to use Werkzeug 3.1.6+
- **File**: `./matrix-studio/requirements.txt`

### Medium Priority (6 Medium Vulnerabilities)
- jinja2, markupsafe, itsdangerous: Transitive dependencies of Flask

**Action**: Upgrade Flask to latest stable version (3.0.0+) which includes all patches

---

## Remediation Steps

### Step 1: Update Node.js Stage Server

**File**: `./matrix-studio/web/stage/package.json`

Replace with dependency-free approach (current setup has no dependencies):
```json
{
  "name": "atlantiplex-stage",
  "version": "1.0.0",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "node server.js"
  }
}
```

**Reason**: Your current server.js uses only Node.js built-in modules (http). No third-party dependencies needed.

**Verification**:
```bash
docker scout cves atlantiplex-stage:latest
```

---

### Step 2: Update Python Flask Backend

**File**: `./matrix-studio/requirements.txt`

```txt
Flask==3.1.0
Werkzeug==3.1.6
```

**Why this fixes vulnerabilities**:
- Flask 3.1.0 includes Werkzeug 3.1.6
- Jinja2 updated to 3.2.0+ (removes CVEs)
- MarkupSafe updated to 3.0.3+ (removes CVEs)
- itsdangerous updated to 2.2.0+ (removes CVEs)

**Update Command**:
```bash
pip install --upgrade Flask==3.1.0 Werkzeug==3.1.6
```

**Verification**:
```bash
docker scout cves atlantiplex-flask:latest
```

---

### Step 3: Update Alpine Base Images (Future)

**Current**: Alpine 3.23
**Recommendation**: Wait for Alpine 3.24 release (Feb 2026) which will include busybox security patches

**For now**: Busybox CVE-2025-60876 is LOW priority and not exploitable in container context

---

## Implementation

### Node.js Changes
<status: No changes needed - already using built-in modules only>

### Python Changes
Apply these updates:

```bash
# Update requirements.txt
Flask==3.1.0
Werkzeug==3.1.6

# Rebuild Flask image
docker-compose -f docker-compose.test.yml build --no-cache flask-backend

# Test
docker scout cves atlantiplex-flask:latest
```

---

## Security Policy Recommendations

1. **Automated Scanning**: Enable Docker Scout in your CI/CD
   - GitHub Actions integration
   - Pre-push checks

2. **Dependency Updates**:
   - Use `npm audit` for Node.js
   - Use `pip-audit` or `safety` for Python
   - Set up Dependabot for auto-updates

3. **Base Image Updates**:
   - Set Alpine to specific versions (alpine:3.23)
   - Monitor for security updates
   - Test upgrades before deploying

4. **Runtime Security**:
   - Your Dockerfiles already use:
     ✓ Non-root users
     ✓ Capability dropping
     ✓ Security opts
     ✓ Health checks

---

## Vulnerability Summary by Severity

| Severity | Stage | Flask | Total | Fixable |
|----------|-------|-------|-------|---------|
| Critical | 0 | 0 | 0 | N/A |
| High | 7 | 2 | 9 | 9 ✓ |
| Medium | 1 | 8 | 9 | 9 ✓ |
| Low | 3 | 3 | 6 | 5 ✓ |
| **Total** | **11** | **13** | **24** | **23 ✓** |

**Remaining (1 unfixed)**:
- busybox CVE-2025-60876 (Alpine package manager, awaiting patch)

---

## Next Steps

1. Update requirements.txt with Flask 3.1.0
2. Rebuild Flask container
3. Run Docker Scout verification
4. Monitor for Alpine 3.24 release
5. Set up continuous scanning with Docker Scout

---

## Sources
- https://docs.docker.com/scout/
- https://scout.docker.com/
